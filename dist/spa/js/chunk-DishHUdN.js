import{r as c,j as e,N as qe,H as Ee,Q as Me,aS as Re,aT as Ie,J as Ue,aU as $e,aV as ce,aW as Be,E as R,x as de,aX as Ve,aY as _e,p as xe,U as Oe,aZ as ze,F as He,a_ as Qe,a$ as Ke,b0 as me,b1 as Ge,b2 as Je}from"./chunk-DgDPklex.js";import{u as Ye,a as We,B as F,b as A,C as p,c as y,P as ge,T as Ze,d as Xe,e as ue,f as he,g as fe,h as pe,i as et,L as d,S as I,j as U,k as $,l as B,m as L,I as m,n as tt}from"./chunk-DDg_V9Pg.js";import{a as ye,b as st,f as V}from"./chunk-DVULmWha.js";import{m as v}from"./chunk-CbcvW3Ig.js";function it(){const{user:je,hasPermission:be}=Ye(),[_,O]=c.useState(!1),[w,z]=c.useState(""),[C,H]=c.useState("all"),[j,Q]=c.useState(""),[b,K]=c.useState(""),[N,G]=c.useState([]),[u,J]=c.useState(!0),[Y,W]=c.useState(null),[Ne,Z]=c.useState(new Date),[P,ve]=c.useState(!0),[h,we]=c.useState({profitMargin:0,inventoryUtilization:0,avgPurchaseValue:0,salesVelocity:0,topPerformingCountry:"",lowStockAlerts:0});if(!je||!be("create_batches"))return e.jsx(qe,{to:"/dashboard",replace:!0});const[s,X]=c.useState({country:"",airline:"",flightDate:"",flightTime:"",buyingPrice:0,quantity:0,agentName:"",agentContact:"",agentAddress:"",remarks:""}),[ee,te]=c.useState(null),[T,q]=c.useState({}),[E,Ce]=c.useState(!1),{toast:S}=We(),f=c.useCallback(async(t=!1)=>{try{t||J(!0),W(null);const l=await ye.getTicketBatches();console.log("ЁЯУК Past purchases data:",l);const r=(l.batches||[]).map(a=>({id:a.id,country:a.country_code,airline:a.airline_name,flightDate:a.flight_date,quantity:a.quantity,buyingPrice:a.buying_price||0,totalCost:(a.buying_price||0)*a.quantity,agentName:a.agent_name,agentContact:a.agent_contact,sold:a.sold_count||0,locked:a.locked_count||0,available:a.available_count||0,profit:st(a.selling_price||0,a.buying_price||0,a.sold_count||0),createdAt:a.created_at}));if(G(r),Z(new Date),r.length>0){const a=r.reduce((n,i)=>n+i.totalCost,0),o=r.reduce((n,i)=>n+i.profit,0),g=r.reduce((n,i)=>n+i.quantity,0),k=r.reduce((n,i)=>n+i.sold,0),ne=r.reduce((n,i)=>{const Le=i.buyingPrice*i.sold;return n+(i.profit+Le)},0),Ae=ne>0?o/ne*100:0,Te=g>0?k/g*100:0,De=r.length>0?a/r.length:0,ie=r.reduce((n,i)=>(n[i.country]||(n[i.country]={sold:0,profit:0,investment:0}),n[i.country].sold+=i.sold,n[i.country].profit+=i.profit,n[i.country].investment+=i.totalCost,n),{}),oe=Object.entries(ie).sort(([,n],[,i])=>i.profit-n.profit)[0]?.[0]||"N/A",Fe=r.filter(n=>n.quantity>0&&n.available/n.quantity<.2).length;console.log("ЁЯУК Real-time metrics calculation:",{totalInvestment:a,totalProfit:o,profitMargin:a>0?o/a*100:0,inventoryUtilization:g>0?k/g*100:0,countryStats:ie,topCountry:oe}),we({profitMargin:Math.max(0,Ae),inventoryUtilization:Math.max(0,Te),avgPurchaseValue:De,salesVelocity:k,topPerformingCountry:oe,lowStockAlerts:Fe})}}catch(l){console.error("тЭМ Failed to load past purchases:",l),t||(W("Failed to load purchase history"),G([]))}finally{t||J(!1)}},[]);c.useEffect(()=>{f()},[f]),c.useEffect(()=>{if(!P)return;const t=setInterval(()=>{f(!0)},45e3);return()=>clearInterval(t)},[P,f]);const se=()=>{const t={};if(s.country.trim()||(t.country="ржжрзЗрж╢ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рж╛ ржЖржмрж╢рзНржпржХ / Country selection is required"),s.airline.trim()||(t.airline="ржПржпрж╝рж╛рж░рж▓рж╛ржЗржи ржирж┐рж░рзНржмя┐╜я┐╜я┐╜ржЪржи ржХрж░рж╛ ржЖржмрж╢рзНржпржХ / Airline selection is required"),!s.flightDate)t.flightDate="ржлрзНрж▓рж╛ржЗржЯя┐╜я┐╜я┐╜рж░ рждрж╛рж░рж┐ржЦ ржЖржмрж╢рзНржпржХ / Flight date is required";else{const r=new Date(s.flightDate),a=new Date,o=new Date;o.setFullYear(a.getFullYear()+1),r<a&&(t.flightDate="ржнржмрж┐рж╖рзНржпрждрзЗрж░ рждрж╛рж░рж┐ржЦ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи / Please select a future date"),r>o&&(t.flightDate="рзз ржмржЫрж░рзЗрж░ ржоя┐╜я┐╜я┐╜рзНржпрзЗ рждрж╛рж░рж┐ржЦ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи / Please select date within 1 year")}if(s.flightTime?/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(s.flightTime)||(t.flightTime="рж╕ржарж┐ржХ рж╕ржоржпрж╝ ржлрж░ржорзНржпрж╛ржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи (HH:MM) / Please use correct time format (HH:MM)"):t.flightTime="ржлрзНрж▓рж╛ржЗржЯрзЗрж░ рж╕ржоржпрж╝ ржЖржмрж╢рзНржпржХ / Flight time is required",!s.buyingPrice||s.buyingPrice<=0?t.buyingPrice="ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп рзж ржПрж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣рждрзЗ рж╣ржмрзЗ / Buying price must be greater than 0":s.buyingPrice<1e3?t.buyingPrice="ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп ржХржоржкржХрзНрж╖рзЗ рззрзжрзжрзж ржЯрж╛ржХрж╛ рж╣рждрзЗ рж╣ржмрзЗ / Buying price must be at least рз│1000":s.buyingPrice>2e5&&(t.buyingPrice="ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп рзи,рзжрзж,рзжрзжрзж ржЯрж╛ржХрж╛рж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣рждрзЗ я┐╜я┐╜я┐╜рж╛рж░рзЗ ржирж╛ / Buying price cannot exceed рз│2,00,000"),!s.quantity||s.quantity<=0?t.quantity="ржЯрж┐ржХрзЗржЯрзЗрж░ рж╕ржВржЦрзНржпрж╛ рзж я┐╜я┐╜я┐╜я┐╜рж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣рждрзЗ рж╣ржмрзЗ / Quantity must be greater than 0":s.quantity>1e3&&(t.quantity="ржПржХржмрж╛рж░рзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ рззя┐╜я┐╜рзжрзж ржЯрж┐ржХрзЗржЯ ржХрзНрж░ржпрж╝ ржХрж░рж╛ ржпрж╛ржмрзЗ / Maximum 1000 tickets can be purchased at once"),s.agentName.trim()?s.agentName.trim().length<3&&(t.agentName="ржПржЬрзЗржирзНржЯрзЗрж░ ржирж╛ржо ржХржоржкржХрзНрж╖рзЗ рзй ржЕржХрзНрж╖рж░ рж╣рждрзЗ рж╣я┐╜я┐╜я┐╜рзЗ / Agent name must be at least 3 characters"):t.agentName="ржПржЬрзЗржирзНржЯрзЗрж░ ржирж╛ржо ржЖржмрж╢рзНржпржХ / Agent name is required",!s.agentContact.trim())t.agentContact="ржПржЬрзЗржирзНржЯрзЗрж░ ржпрзЛржЧрж╛ржпрзЛржЧ ржиржорзНржмрж░ ржЖржмрж╢рзНя┐╜я┐╜я┐╜ржХ / Agent contact is required";else{const r=/^(\+880|880|0)?(1[3-9]\d{8})$/,a=s.agentContact.replace(/[\s-]/g,"");r.test(a)||(t.agentContact="рж╕ржарж┐ржХ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рж┐ ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░ ржжрж┐ржи / Please provide valid Bangladeshi mobile number")}return s.agentAddress&&s.agentAddress.trim().length>0&&s.agentAddress.trim().length<10&&(t.agentAddress="ржарж┐ржХрж╛ржирж╛ ржХржоржкржХрзНрж╖рзЗ рззрзж ржЕржХрзНрж╖рж░ рж╣рждрзЗ рж╣ржмрзЗ / Address must be at least 10 characters"),s.buyingPrice*s.quantity>5e7&&(t.general="ржорзЛржЯ ржЦрж░ржЪ рзл ржХрзЛржЯрж┐ ржЯрж╛ржХрж╛рж░ ржмрзЗрж╢рж┐ рж╣рждрзЗ ржкрж╛рж░рзЗ ржирж╛ / Total cost cannot exceed рз│5 crore"),t},ae=()=>{const t={};return N.find(a=>a.country===s.country&&a.airline===s.airline&&a.flightDate===s.flightDate)&&(t.duplicate="ржПржХржЗ ржжрж┐ржирзЗ, я┐╜я┐╜я┐╜ржХржЗ ржПржпрж╝рж╛рж░рж▓рж╛ржЗржирзЗрж░ ржЬржирзНржп ржЗрждрж┐ржоржзрзНржпрзЗ ржЯрж┐ржХрзЗржЯ ржХрзНрж░ржпрж╝ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ / Tickets already purchased for same airline on this date"),s.buyingPrice*1.15-s.buyingPrice<s.buyingPrice*.1&&(t.profit="рж▓рж╛ржнрзЗрж░ ржорж╛рж░рзНржЬрж┐ржи ржХржоржкржХрзНрж╖рзЗ рззрзж% рж░рж╛ржЦрзБржи / Keep minimum 10% profit margin"),t};c.useEffect(()=>{const t=se(),l=ae(),r={...t,...l};q(r),Ce(Object.keys(r).length===0)},[s]);const le=()=>{const t=s.buyingPrice*s.quantity,l=Math.round(s.buyingPrice*1.2),r=l*s.quantity,a=r-t;return{totalCost:t,estimatedSellingPrice:l,estimatedRevenue:r,estimatedProfit:a,profitMargin:t>0?(a/t*100).toFixed(1):"0"}},M=[{code:"KSA",name:"Saudi Arabia",flag:"ЁЯЗ╕ЁЯЗж"},{code:"UAE",name:"United Arab Emirates",flag:"ЁЯЗжЁЯЗк"},{code:"QAT",name:"Qatar",flag:"ЁЯЗ╢ЁЯЗж"},{code:"KWT",name:"Kuwait",flag:"ЁЯЗ░ЁЯЗ╝"},{code:"OMN",name:"Oman",flag:"ЁЯЗ┤ЁЯЗ▓"},{code:"BHR",name:"Bahrain",flag:"ЁЯЗзЁЯЗн"},{code:"JOR",name:"Jordan",flag:"ЁЯЗпЁЯЗ┤"},{code:"LBN",name:"Lebanon",flag:"я┐╜я┐╜я┐╜ЁЯЗз"}],Pe=["Air Arabia","Emirates","Qatar Airways","Saudi Airlines","Flydubai","Kuwait Airways","Oman Air","Gulf Air"],x=(t,l)=>{X(r=>({...r,[t]:l}))},Se=t=>{const l=t.target.files?.[0];l&&te(l)},ke=async t=>{t.preventDefault();const l=se(),r=ae(),a={...l,...r};if(Object.keys(a).length>0){q(a),S({title:"ржнрзНржпрж╛я┐╜я┐╜я┐╜рж┐ржбрзЗрж╢ржи рждрзНрж░рзБржЯрж┐ / Validation Error",description:"ржжржпрж╝рж╛ ржХрж░рзЗ рж╕ржм ржХрзНрж╖рзЗрждрзНрж░ рж╕ржарж┐ржХржнрж╛ржмрзЗ ржкрзВрж░ржг ржХрж░рзБржи / Please fill all fields correctly",variant:"destructive"});return}const o=le();if(o.totalCost<=0){S({title:"ржЖрж░рзНржерж┐ржХ рждрзНрж░рзБржЯрж┐ / Financial Error",description:"ржорзЛржЯ ржЦрж░ржЪ рж╢рзВржирзНржпрзЗрж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣рждрзЗ рж╣ржмрзЗ / Total cost must be greater than zero",variant:"destructive"});return}if(!(o.totalCost>1e6&&!window.confirm(`ржмржбрж╝ ржкрж░рж┐я┐╜я┐╜я┐╜рж╛ржг ржХрзНрж░ржпрж╝: рз│${o.totalCost.toLocaleString()}

ржЖржкржирж┐ ржХрж┐ ржирж┐рж╢рзНржЪя┐╜я┐╜я┐╜ржд?

Large purchase: рз│${o.totalCost.toLocaleString()}

Are you sure?`))){O(!0);try{S({title:"ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг / Processing",description:"ржЯрж┐ржХрзЗржЯ ржмрзНржпрж╛ржЪ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ / Creating ticket batch..."}),console.log("=== ржЯрж┐ржХрзЗржЯ ржХя┐╜я┐╜я┐╜рж░ржпрж╝ ржЕржбрж┐ржЯ рж▓ржЧ / TICKET PURCHASE AUDIT LOG ==="),console.log("ржжрзЗрж╢ / Country:",s.country),console.log("ржПржпрж╝рж╛рж░рж▓рж╛ржЗржи / Airline:",s.airline),console.log("ржлрзНрж▓рж╛ржЗржЯ рждрж╛рж░рж┐ржЦ / Flight Date:",s.flightDate),console.log("ржкрж░рж┐ржорж╛ржг / Quantity:",s.quantity),console.log("ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп / Buying Price:",`рз│${s.buyingPrice.toLocaleString()}`),console.log("ржорзЛржЯ ржЦрж░ржЪ / Total Cost:",`рз│${o.totalCost.toLocaleString()}`),console.log("я┐╜я┐╜рзНрж░рждрзНя┐╜я┐╜я┐╜рж╛рж╢рж┐ржд ржмрж┐ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп / Expected Selling Price:",`рз│${o.estimatedSellingPrice.toLocaleString()}`),console.log("ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржорзБржирж╛ржлрж╛ / Expected Profit:",`рз│${o.estimatedProfit.toLocaleString()}`),console.log("ржорзБржирж╛ржлрж╛рж░ рж╣рж╛рж░ / Profit Margin:",`${o.profitMargin}%`),console.log("ржПржЬрзЗржирзНржЯ / Agent:",s.agentName),console.log("ржпрзЛржЧрж╛ржпрзЛржЧ / Contact:",s.agentContact),console.log("рж╕ржоржпрж╝ / Time:",new Date().toLocaleString()),console.log("=== рж▓ржЧ рж╢рзЗрж╖ / END LOG ===");const g=await ye.createTicketBatch(s);console.log("ржЯрж┐ржХрзЗржЯ ржмрзНржпрж╛ржЪ рждрзИрж░я┐╜я┐╜я┐╜ рж╕ржлрж▓ / Ticket batch created successfully:",g);const k=`тЬЕ рж╕ржлрж▓ржнрж╛ржмрзЗ рж╕ржорзНржкржирзНржи / Successfully Completed!

ЁЯУК ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд / Details:
тАв ржжрзЗрж╢ / Country: ${s.country}
тАв ржПржпрж╝рж╛рж░рж▓рж╛ржЗржи / Airline: ${s.airline}
тАв ржЯрж┐ржХрзЗржЯ рж╕ржВржЦрзНржпрж╛ / Tickets: ${s.quantity}
тАв ржорзЛржЯ ржЦрж░ржЪ / Total Cost: рз│${o.totalCost.toLocaleString()}
тАв ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржорзБржирж╛ржлрж╛ / Expected Profit: рз│${o.estimatedProfit.toLocaleString()}
тАв ржорзБржирж╛ржлрж╛рж░ рж╣рж╛рж░ / Profit Margin: ${o.profitMargin}%`;S({title:"рж╕ржлрж▓ / Success!",description:"ржЯя┐╜я┐╜я┐╜ржХрзЗржЯ ржмрзНржпрж╛ржЪ рж╕ржлрж▓ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣я┐╜я┐╜я┐╜рж╝рзЗржЫрзЗ / Ticket batch created successfully"}),X({country:"",airline:"",flightDate:"",flightTime:"",buyingPrice:0,quantity:0,agentName:"",agentContact:"",agentAddress:"",remarks:""}),te(null),q({}),f(),alert(k)}catch(g){console.error("Error creating ticket batch:",g),S({title:"рждрзНрж░рзБржЯрж┐ / Error",description:"ржЯрж┐ржХрзЗржЯ ржмрзНржпрж╛ржЪ рждрзИрж░рж┐рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ / Failed to create ticket batch",variant:"destructive"})}finally{O(!1)}}},re=N.filter(t=>{const l=t.airline.toLowerCase().includes(w.toLowerCase())||t.agentName.toLowerCase().includes(w.toLowerCase()),r=C==="all"||t.country===C;let a=!0;if(j||b){const o=new Date(t.createdAt);j&&o<new Date(j)&&(a=!1),b&&o>new Date(b)&&(a=!1)}return l&&r&&a}),D={totalInvestment:u?0:N.reduce((t,l)=>t+l.totalCost,0),totalProfit:u?0:N.reduce((t,l)=>t+l.profit,0),totalTickets:u?0:N.reduce((t,l)=>t+l.quantity,0),totalSold:u?0:N.reduce((t,l)=>t+l.sold,0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-luxury-gold to-luxury-bronze rounded-full animate-glow animate-float",children:e.jsx(Ee,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"responsive-heading font-heading font-bold velvet-text",children:"Admin Ticket Buying"}),e.jsx("p",{className:"text-foreground/70 font-body",children:"Purchase and manage flight ticket inventory"})]})]}),e.jsxs("div",{className:"flex flex-wrap lg:flex-nowrap items-center gap-4 lg:space-x-6 luxury-card p-4 rounded-lg border-0 min-w-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"responsive-text font-heading font-bold text-primary velvet-text",children:u?e.jsx("div",{className:"w-16 h-6 bg-gray-200 rounded animate-pulse mx-auto"}):V(D.totalInvestment)}),e.jsx("p",{className:"text-xs font-body text-foreground/60",children:"Total Investment"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"responsive-text font-heading font-bold text-green-600 velvet-text",children:u?e.jsx("div",{className:"w-16 h-6 bg-gray-200 rounded animate-pulse mx-auto"}):V(D.totalProfit)}),e.jsx("p",{className:"text-xs font-body text-foreground/60",children:"Total Profit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"responsive-text font-heading font-bold text-blue-600 velvet-text",children:u?e.jsx("div",{className:"w-12 h-6 bg-gray-200 rounded animate-pulse mx-auto"}):`${D.totalSold}/${D.totalTickets}`}),e.jsx("p",{className:"text-xs font-body text-foreground/60",children:"Sold/Total"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(F,{onClick:()=>{Z(new Date),f()},variant:"outline",size:"sm",className:"touch-target",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})}),e.jsx("div",{className:"text-center",children:e.jsxs(A,{variant:P?"default":"secondary",className:"touch-target cursor-pointer",onClick:()=>ve(!P),children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),P?"Live":"Manual"]})})]})]})}),e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsx(p,{className:"luxury-card border-0",children:e.jsxs(y,{className:"responsive-padding pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-body text-foreground/70",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-heading font-bold text-green-600",children:[h.profitMargin.toFixed(1),"%"]})]}),e.jsx(Ie,{className:"h-8 w-8 text-green-500"})]}),e.jsx(ge,{value:Math.min(h.profitMargin,100),className:"mt-3 h-2"})]})}),e.jsx(p,{className:"luxury-card border-0",children:e.jsxs(y,{className:"responsive-padding pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-body text-foreground/70",children:"Inventory Utilization"}),e.jsxs("p",{className:"text-2xl font-heading font-bold text-blue-600",children:[h.inventoryUtilization.toFixed(1),"%"]})]}),e.jsx(Ue,{className:"h-8 w-8 text-blue-500"})]}),e.jsx(ge,{value:h.inventoryUtilization,className:"mt-3 h-2"})]})}),e.jsx(p,{className:"luxury-card border-0",children:e.jsx(y,{className:"responsive-padding pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-body text-foreground/70",children:"Avg Purchase Value"}),e.jsx("p",{className:"text-2xl font-heading font-bold text-purple-600",children:V(h.avgPurchaseValue)})]}),e.jsx($e,{className:"h-8 w-8 text-purple-500"})]})})}),e.jsx(p,{className:"luxury-card border-0",children:e.jsx(y,{className:"responsive-padding pt-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-body text-foreground/70",children:"Top Country"}),e.jsx("span",{className:"font-heading font-bold text-yellow-600",children:h.topPerformingCountry})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-body text-foreground/70",children:"Low Stock Alerts"}),e.jsx(A,{variant:h.lowStockAlerts>0?"destructive":"secondary",children:h.lowStockAlerts})]}),e.jsx("div",{className:"pt-2 border-t border-border/20",children:e.jsxs("p",{className:"text-xs text-foreground/50 font-body",children:["Last updated: ",Ne.toLocaleTimeString()]})})]})})})]}),e.jsxs(Ze,{defaultValue:"add-tickets",className:"space-y-6",children:[e.jsxs(Xe,{className:"grid w-full grid-cols-1 sm:grid-cols-2 luxury-card border-0 p-1 gap-1 sm:gap-0",children:[e.jsxs(ue,{value:"add-tickets",className:"data-[state=active]:velvet-button data-[state=active]:text-primary-foreground font-body",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add New Tickets"]}),e.jsxs(ue,{value:"past-purchases",className:"data-[state=active]:velvet-button data-[state=active]:text-primary-foreground font-body",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Past Purchases"]})]}),e.jsx(he,{value:"add-tickets",children:e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsxs(p,{className:"luxury-card border-0",children:[e.jsxs(fe,{children:[e.jsxs(pe,{className:"font-heading velvet-text flex items-center space-x-2",children:[e.jsx(R,{className:"h-5 w-5"}),e.jsx("span",{children:"Add New Ticket Batch"})]}),e.jsx(et,{className:"font-body",children:"Enter ticket details to add new inventory to the system"})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:ke,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Country"}),e.jsxs(I,{value:s.country,onValueChange:t=>x("country",t),required:!0,children:[e.jsx(U,{className:"font-body",children:e.jsx($,{placeholder:"Select destination country"})}),e.jsx(B,{children:M.map(t=>e.jsxs(L,{value:t.code,children:[t.flag," ",t.name]},t.code))})]}),T.country&&e.jsx("p",{className:"text-red-500 text-sm font-body mt-1",children:T.country})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Airline"}),e.jsxs(I,{value:s.airline,onValueChange:t=>x("airline",t),required:!0,children:[e.jsx(U,{className:"font-body",children:e.jsx($,{placeholder:"Select airline"})}),e.jsx(B,{children:Pe.map(t=>e.jsx(L,{value:t,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{children:t})]})},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Flight Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{type:"date",value:s.flightDate,onChange:t=>x("flightDate",t.target.value),className:"pl-10 font-body",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Flight Time"}),e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{type:"time",value:s.flightTime,onChange:t=>x("flightTime",t.target.value),className:"pl-10 font-body",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Buying Price (Per Ticket)"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{type:"number",value:s.buyingPrice||"",onChange:t=>x("buyingPrice",parseInt(t.target.value)||0),className:"pl-10 font-body",placeholder:"Enter buying price per ticket",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Total Tickets"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{type:"number",value:s.quantity||"",onChange:t=>x("quantity",parseInt(t.target.value)||0),className:"pl-10 font-body",placeholder:"20",required:!0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Agent/Seller Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{value:s.agentName,onChange:t=>x("agentName",t.target.value),className:"pl-10 font-body",placeholder:"Ahmed Travel Agency",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Agent Contact (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{value:s.agentContact,onChange:t=>x("agentContact",t.target.value),className:"pl-10 font-body",placeholder:"Enter agent contact number"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Agent Address (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{value:s.agentAddress,onChange:t=>x("agentAddress",t.target.value),className:"pl-10 font-body",placeholder:"Dhanmondi, Dhaka"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Remarks (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qe,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(tt,{value:s.remarks,onChange:t=>x("remarks",t.target.value),className:"pl-10 font-body min-h-[80px]",placeholder:"Any additional notes about this batch..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"font-body font-medium",children:"Upload Invoice (Optional)"}),e.jsxs("div",{className:"border-2 border-dashed border-border/50 rounded-lg p-4 text-center hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:Se,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(Ke,{className:"h-8 w-8 text-foreground/40 mx-auto mb-2"}),e.jsx("p",{className:"font-body text-sm text-foreground/70",children:ee?ee.name:"Click to upload PDF or Image"})]})]})]})]}),s.quantity>0&&s.buyingPrice>0&&e.jsx(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"space-y-4",children:(()=>{const t=le();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-heading font-semibold text-blue-800 mb-3 flex items-center",children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"ржЖрж░рзНржерж┐ржХ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг / Financial Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm font-body",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржЯрж┐ржХрзЗржЯ ржкрзНрж░рждрж┐ ржжрж╛ржо / Price per Ticket"}),e.jsxs("span",{className:"font-bold text-blue-600 text-lg",children:["рз│",s.buyingPrice.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржорзЛржЯ ржЯрж┐ржХрзЗржЯ / Total Tickets"}),e.jsx("span",{className:"font-bold text-blue-600 text-lg",children:s.quantity})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржорзЛржЯ ржЦрж░ржЪ / Total Cost"}),e.jsxs("span",{className:"font-bold text-red-600 text-lg",children:["рз│",t.totalCost.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржмрж┐ржХрзНрж░ржпрж╝ ржорзВрж▓рзНржп / Expected Selling Price"}),e.jsxs("span",{className:"font-bold text-green-600 text-lg",children:["рз│",t.estimatedSellingPrice.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"font-heading font-semibold text-green-800 mb-3 flex items-center",children:[e.jsx(me,{className:"h-5 w-5 mr-2"}),"ржорзБржирж╛ржлрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг / Profit Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm font-body",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржЖржпрж╝ / Expected Revenue"}),e.jsxs("span",{className:"font-bold text-green-600 text-xl",children:["рз│",t.estimatedRevenue.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржорзБя┐╜я┐╜рж╛ржлрж╛ / Expected Profit"}),e.jsxs("span",{className:"font-bold text-green-600 text-xl",children:["рз│",t.estimatedProfit.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-gray-600 block",children:"ржорзБржирж╛ржлрж╛рж░ рж╣я┐╜я┐╜я┐╜рж░ / Profit Margin"}),e.jsxs("span",{className:`font-bold text-xl ${parseFloat(t.profitMargin)>=20?"text-green-600":parseFloat(t.profitMargin)>=10?"text-yellow-600":"text-red-600"}`,children:[t.profitMargin,"%"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg border border-yellow-200",children:[e.jsxs("h3",{className:"font-heading font-semibold text-yellow-800 mb-3 flex items-center",children:[e.jsx(R,{className:"h-5 w-5 mr-2"}),"ржЭрзБржБржХрж┐ ржорзВрж▓рзНржпрж╛ржпрж╝ржи / Risk Assessment"]}),e.jsxs("div",{className:"space-y-2 text-sm font-body",children:[t.totalCost>5e6&&e.jsx("div",{className:"bg-red-100 border border-red-300 p-2 rounded flex items-center",children:e.jsx("span",{className:"text-red-600 font-semibold",children:"тЪая╕П ржЙржЪрзНржЪ ржЭрзБржБржХрж┐: рзлрзж рж▓рж╛ржЦ ржЯрж╛ржХрж╛я┐╜я┐╜ ржмрзЗрж╢рж┐ ржмрж┐ржирж┐ржпрж╝рзЛржЧ / High Risk: Investment over рз│50 lakh"})}),parseFloat(t.profitMargin)<10&&e.jsx("div",{className:"bg-orange-100 border border-orange-300 p-2 rounded flex items-center",children:e.jsx("span",{className:"text-orange-600 font-semibold",children:"тЪая╕П ржХржо ржорзБржирж╛ржлрж╛: рззрзж% ржПрж░ ржХржо / Low Profit: Less than 10%"})}),s.quantity>500&&e.jsx("div",{className:"bg-yellow-100 border border-yellow-300 p-2 rounded flex items-center",children:e.jsx("span",{className:"text-yellow-600 font-semibold",children:"тЪая╕П ржмржбрж╝ ржкрж░рж┐ржорж╛ржг: рзля┐╜я┐╜я┐╜рзж+ ржЯрж┐ржХрзЗржЯ / Large Quantity: 500+ tickets"})}),parseFloat(t.profitMargin)>=20&&t.totalCost<=1e6&&e.jsx("div",{className:"bg-green-100 border border-green-300 p-2 rounded flex items-center",children:e.jsx("span",{className:"text-green-600 font-semibold",children:"тЬЕ ржирж┐рж░рж╛ржкржж ржмрж┐ржирж┐ржпрж╝рзЛржЧ: ржнрж╛рж▓ ржорзБржирж╛ржлрж╛рж░ рж╣рж╛рж░ / Safe Investment: Good profit margin"})})]})]})]})})()}),Object.keys(T).length>0&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"рждрзНрж░рзБржЯрж┐ рж╕ржорзВрж╣ / Validation Errors:"}),e.jsx("ul",{className:"space-y-1 text-sm text-red-600",children:Object.values(T).map((t,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-red-500 mr-2",children:"тАв"}),t]},l))})]}),e.jsx(F,{type:"submit",disabled:_||!E,className:`w-full font-body text-lg py-3 hover:scale-105 transform transition-all duration-200 ${E?"velvet-button text-primary-foreground":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:_?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"ржЯрж┐ржХрзЗржЯ ржЗржиржнрзЗржирзНржЯрж░рж┐рждрзЗ ржпрзЛржЧ ржХрж░рж╛ рж╣ржЪрзНржЫя┐╜я┐╜я┐╜... / Adding to Inventory..."})]}):E?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"ржЗржиржнрзЗржирзНржЯрж░рж┐рждрзЗ ржпрзЛржЧ ржХрж░рзБржи / Add to Inventory"})]}):e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{children:"рж╕ржм рждржерзНржп рж╕ржарж┐ржХржнрж╛ржмрзЗ ржкрзВрж░ржг ржХрж░рзБржи / Please fill all fields correctly"})})})]})})]})})}),e.jsx(he,{value:"past-purchases",children:e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-6",children:[e.jsxs(p,{className:"luxury-card border-0",children:[e.jsx(fe,{children:e.jsxs(pe,{className:"font-heading velvet-text flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),e.jsx("span",{children:"Filter Purchases"})]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-3 h-4 w-4 text-foreground/40"}),e.jsx(m,{placeholder:"Search airline or agent...",value:w,onChange:t=>z(t.target.value),className:"pl-10 font-body"})]}),e.jsxs(I,{value:C,onValueChange:H,children:[e.jsx(U,{className:"font-body",children:e.jsx($,{placeholder:"Filter by country"})}),e.jsxs(B,{children:[e.jsx(L,{value:"all",children:"All Countries"}),M.map(t=>e.jsxs(L,{value:t.code,children:[t.flag," ",t.name]},t.code))]})]}),e.jsx(m,{type:"date",placeholder:"From date",value:j,onChange:t=>Q(t.target.value),className:"font-body"}),e.jsx(m,{type:"date",placeholder:"To date",value:b,onChange:t=>K(t.target.value),className:"font-body"})]})})]}),e.jsx(p,{className:"luxury-card border-0",children:e.jsx(y,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-cream-100 to-cream-200 border-b border-border/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Country"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Airline"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Flight Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Buying Price"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Agent"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left font-heading font-semibold text-sm text-foreground velvet-text",children:"Profit"})]})}),e.jsx("tbody",{children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-primary/30 border-t-primary rounded-full animate-spin"}),e.jsx("span",{className:"font-body text-foreground/70",children:"Loading purchases..."})]})})}):Y?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"text-6xl",children:"тЪая╕П"}),e.jsx("h3",{className:"font-heading font-bold text-foreground",children:"Error Loading Purchases"}),e.jsx("p",{className:"font-body text-foreground/70",children:Y}),e.jsx(F,{onClick:f,variant:"outline",size:"sm",className:"font-body",children:"Retry"})]})})}):re.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"text-6xl",children:"ЁЯОп"}),e.jsx("h3",{className:"font-heading font-bold text-green-600",children:"Ready for New Purchases!"}),e.jsx("p",{className:"font-body text-foreground/70",children:w||C!=="all"||j||b?"No purchases match your filters. Try adjusting your search criteria.":"No ticket purchases yet. Start by adding new tickets through the 'Add New Tickets' tab."}),(w||C!=="all"||j||b)&&e.jsx(F,{onClick:()=>{z(""),H("all"),Q(""),K("")},variant:"outline",size:"sm",className:"font-body",children:"Clear Filters"})]})})}):re.map((t,l)=>e.jsxs(v.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1,duration:.3},className:"border-b border-border/20 hover:bg-gradient-to-r hover:from-cream-100/50 hover:to-transparent transition-all duration-300",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:M.find(r=>r.code===t.country)?.flag}),e.jsx("span",{className:"font-body font-medium text-sm text-foreground",children:t.country})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-4 w-4 text-foreground/40"}),e.jsx("span",{className:"font-body text-sm text-foreground",children:t.airline})]})}),e.jsx("td",{className:"px-4 py-3 font-body text-sm text-foreground",children:t.flightDate}),e.jsx("td",{className:"px-4 py-3 font-body text-sm text-foreground",children:t.quantity}),e.jsxs("td",{className:"px-4 py-3 font-body text-sm text-foreground",children:["рз│",t.buyingPrice.toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 font-body font-semibold text-sm text-foreground",children:["рз│",t.totalCost.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-body font-medium text-sm text-foreground",children:t.agentName}),t.agentContact&&e.jsx("p",{className:"font-body text-xs text-foreground/60",children:t.agentContact})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex space-x-1",children:e.jsxs(A,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200 text-xs",children:[t.sold," Sold"]})}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs(A,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200 text-xs",children:[t.locked," Locked"]}),e.jsxs(A,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 text-xs",children:[t.available," Available"]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"font-body font-semibold text-sm text-green-600",children:["рз│",t.profit.toLocaleString()]})]})})]},t.id))})]})})})})]})})]})]})}export{it as A};
