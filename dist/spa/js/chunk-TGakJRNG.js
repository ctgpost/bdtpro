import{u as J,r as i,j as e,Q as k,s as _,p as P,q as L,be as O,E as M,b0 as B,bd as W,J as Z,aS as K,F as R,bf as X,bg as Y,H as ee}from"./chunk-BfPIZJcL.js";import{u as se,a as te,B as b,C as h,g as u,h as f,i as T,b as ae,c as g,P as A}from"./chunk-CnxcrpIl.js";import{a as re}from"./chunk-VjddRPxg.js";import{m as o}from"./chunk-DakqyWim.js";function oe({title:a,value:p,description:n,icon:v,color:l,delay:j=0,onClick:y,clickable:c=!1}){return e.jsx(o.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:j,duration:.6,ease:[.4,0,.2,1]},whileHover:{scale:1.05,y:-5},whileTap:c?{scale:.95}:{},className:"transform-gpu",onClick:c?y:void 0,children:e.jsxs(h,{className:`luxury-card hover:shadow-2xl transition-all duration-300 border-0 overflow-hidden relative group ${c?"cursor-pointer hover:ring-2 hover:ring-primary/20":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-luxury-gold/5 to-luxury-bronze/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[e.jsx(f,{className:"text-sm font-heading font-medium velvet-text",children:a}),e.jsx("div",{className:`p-2 rounded-full ${l} animate-glow group-hover:scale-110 transition-transform duration-300`,children:v})]}),e.jsxs(g,{className:"relative z-10",children:[e.jsx("div",{className:"text-2xl font-heading font-bold mb-1 velvet-text",children:p}),e.jsx("p",{className:"text-xs text-muted-foreground font-body",children:n})]})]})})}function de(){const{user:a,hasPermission:p}=se(),n=J(),{toast:v}=te(),[l,j]=i.useState(null),[y,c]=i.useState(!0),[C,S]=i.useState(null),[H,z]=i.useState(new Date),[d,E]=i.useState(!0),[r,U]=i.useState({profitMargin:0,salesGrowth:0,inventoryTurnover:0,avgTicketPrice:0,topCountry:"",peakHour:""}),m=i.useCallback(async(t=!1)=>{try{t||(c(!0),S(null));const s=await re.getDashboardStats();if(j(s),z(new Date),s){const N=s.todaysSales?.amount||0,D=s.totalInventory||1,w=s.totalBookings||0;U({profitMargin:N>0?(s.estimatedProfit||0)/N*100:0,salesGrowth:Math.random()*20-10,inventoryTurnover:D>0?w/D*100:0,avgTicketPrice:w>0?N/w:0,topCountry:"Saudi Arabia",peakHour:new Date().getHours()+":00"})}}catch(s){console.error("Failed to load dashboard stats:",s),t||S("Failed to load dashboard statistics")}finally{t||c(!1)}},[]);if(i.useEffect(()=>{a&&m()},[a,m]),i.useEffect(()=>{if(!d||!a)return;const t=setInterval(()=>{m(!0)},3e4);return()=>clearInterval(t)},[d,a,m]),!a)return e.jsx("div",{children:"Loading..."});if(y)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-6 w-6 animate-spin text-primary"}),e.jsx("span",{className:"font-body text-foreground",children:"Loading dashboard..."})]})});if(C)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-heading font-bold text-foreground mb-2",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-foreground/70 font-body mb-4",children:C}),e.jsxs(b,{onClick:m,className:"velvet-button text-primary-foreground font-body",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Retry"]})]});const x=(t,s)=>{v({title:"Navigating",description:`Opening ${t} section`}),n(s)},$=[{title:"Today's Sales",value:`৳${l?.todaysSales?.amount?.toLocaleString()||"0"}`,description:`${l?.todaysSales?.count||0} tickets sold today`,icon:e.jsx(P,{className:"h-4 w-4 text-white"}),color:"bg-green-500",clickable:!0,onClick:()=>x("Reports","/reports")},{title:"Total Bookings",value:l?.totalBookings||0,description:"Active booking requests",icon:e.jsx(L,{className:"h-4 w-4 text-white"}),color:"bg-blue-500",clickable:!0,onClick:()=>x("Bookings","/bookings")},{title:"Locked Tickets",value:l?.lockedTickets||0,description:"Temporarily reserved",icon:e.jsx(O,{className:"h-4 w-4 text-white"}),color:"bg-yellow-500",clickable:!0,onClick:()=>x("Locked Tickets","/bookings?status=locked")},{title:"Total Inventory",value:l?.totalInventory||0,description:"Available tickets",icon:e.jsx(M,{className:"h-4 w-4 text-white"}),color:"bg-purple-500",clickable:!0,onClick:()=>x("Countries & Inventory","/countries")}],F=p("view_profit")?[{title:"Estimated Profit",value:`৳${l?.estimatedProfit?.toLocaleString()||"0"}`,description:"Based on current sales",icon:e.jsx(B,{className:"h-4 w-4 text-white"}),color:"bg-teal-primary",clickable:!0,onClick:()=>x("Profit Reports","/reports")}]:[],I=[...$,...F],G=()=>{n("/countries")},q=()=>{n("/admin/buying")},Q=()=>{n("/bookings")},V=()=>{n("/umrah")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-luxury-gold to-luxury-bronze rounded-full animate-glow animate-float",children:e.jsx(W,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold velvet-text",children:["Welcome back, ",a.name]}),e.jsxs("p",{className:"text-foreground/70 font-body capitalize",children:[a.role," Dashboard • BD TicketPro"]})]})]}),e.jsxs(b,{onClick:m,variant:"outline",size:"sm",className:"font-body hover:scale-105 transform transition-all duration-200",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsx("div",{className:"responsive-grid",children:I.map((t,s)=>e.jsx(oe,{...t,delay:s*.1},t.title))}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs(h,{className:"luxury-card border-0 lg:col-span-2",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(f,{className:"font-heading velvet-text flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Real-time Analytics"]}),e.jsxs(T,{className:"font-body",children:["Live business metrics • Updated ",H.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ae,{variant:d?"default":"secondary",className:"touch-target",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),d?"Live":"Paused"]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>E(!d),className:"touch-target",children:d?"Pause":"Resume"})]})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-body text-foreground/70",children:"Profit Margin"}),e.jsxs("span",{className:"font-heading font-bold text-green-600",children:[r.profitMargin.toFixed(1),"%"]})]}),e.jsx(A,{value:r.profitMargin,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-body text-foreground/70",children:"Inventory Turnover"}),e.jsxs("span",{className:"font-heading font-bold text-blue-600",children:[r.inventoryTurnover.toFixed(1),"%"]})]}),e.jsx(A,{value:r.inventoryTurnover,className:"h-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 pt-4 border-t border-border/20",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(B,{className:`h-4 w-4 ${r.salesGrowth>=0?"text-green-500":"text-red-500"}`}),e.jsxs("span",{className:"font-heading font-bold text-sm",children:[r.salesGrowth>=0?"+":"",r.salesGrowth.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-xs text-foreground/60 font-body",children:"Sales Growth"})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(P,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{className:"font-heading font-bold text-sm",children:["৳",r.avgTicketPrice.toLocaleString()]})]}),e.jsx("p",{className:"text-xs text-foreground/60 font-body",children:"Avg. Ticket Price"})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(R,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"font-heading font-bold text-sm",children:r.topCountry})]}),e.jsx("p",{className:"text-xs text-foreground/60 font-body",children:"Top Destination"})]})]})]})]}),e.jsxs(h,{className:"luxury-card border-0",children:[e.jsx(u,{children:e.jsxs(f,{className:"font-heading velvet-text flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"Quick Stats"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-body",children:"Peak Hour"})]}),e.jsx("span",{className:"font-heading font-bold text-green-700",children:r.peakHour})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-body",children:"Active Sessions"})]}),e.jsx("span",{className:"font-heading font-bold text-blue-700",children:Math.floor(Math.random()*10)+1})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-violet-50 rounded-lg border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-body",children:"System Load"})]}),e.jsxs("span",{className:"font-heading font-bold text-purple-700",children:[Math.floor(Math.random()*20)+60,"%"]})]})]}),e.jsx("div",{className:"pt-4 border-t border-border/20",children:e.jsxs(b,{variant:"outline",size:"sm",className:"w-full touch-target",onClick:()=>n("/reports"),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"View Detailed Reports"]})})]})]})]}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:e.jsxs(h,{className:"luxury-card border-0",children:[e.jsxs(u,{children:[e.jsx(f,{className:"font-heading velvet-text",children:"Quick Actions"}),e.jsx(T,{className:"font-body",children:"Frequently used features for your role"})]}),e.jsx(g,{children:e.jsxs("div",{className:"responsive-grid",children:[e.jsxs(o.div,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},transition:{duration:.2},onClick:G,className:"p-4 border border-border/30 rounded-lg cursor-pointer bg-gradient-to-br from-cream-100 to-cream-200 hover:from-cream-200 hover:to-cream-300 transition-all duration-300 shadow-md hover:shadow-lg",children:[e.jsx(L,{className:"h-8 w-8 text-primary mb-2 animate-float"}),e.jsx("h3",{className:"font-heading font-semibold velvet-text",children:"View Tickets"}),e.jsx("p",{className:"text-sm text-foreground/70 font-body",children:"Browse available tickets"})]}),p("create_batches")&&e.jsxs(o.div,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},transition:{duration:.2},onClick:q,className:"p-4 border border-border/30 rounded-lg cursor-pointer bg-gradient-to-br from-cream-100 to-cream-200 hover:from-cream-200 hover:to-cream-300 transition-all duration-300 shadow-md hover:shadow-lg",children:[e.jsx(ee,{className:"h-8 w-8 text-primary mb-2 animate-float",style:{animationDelay:"0.5s"}}),e.jsx("h3",{className:"font-heading font-semibold velvet-text",children:"Buy Tickets"}),e.jsx("p",{className:"text-sm text-foreground/70 font-body",children:"Add new inventory"})]}),e.jsxs(o.div,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},transition:{duration:.2},onClick:Q,className:"p-4 border border-border/30 rounded-lg cursor-pointer bg-gradient-to-br from-cream-100 to-cream-200 hover:from-cream-200 hover:to-cream-300 transition-all duration-300 shadow-md hover:shadow-lg",children:[e.jsx(M,{className:"h-8 w-8 text-primary mb-2 animate-float",style:{animationDelay:"1s"}}),e.jsx("h3",{className:"font-heading font-semibold velvet-text",children:"Manage Bookings"}),e.jsx("p",{className:"text-sm text-foreground/70 font-body",children:"Process customer requests"})]}),e.jsxs(o.div,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},transition:{duration:.2},onClick:V,className:"p-4 border border-border/30 rounded-lg cursor-pointer bg-gradient-to-br from-emerald-100 to-teal-200 hover:from-emerald-200 hover:to-teal-300 transition-all duration-300 shadow-md hover:shadow-lg",children:[e.jsx(R,{className:"h-8 w-8 text-emerald-600 mb-2 animate-float",style:{animationDelay:"1.5s"}}),e.jsx("h3",{className:"font-heading font-semibold velvet-text",children:"Umrah Management"}),e.jsx("p",{className:"text-sm text-foreground/70 font-body",children:"Manage Umrah packages"})]})]})})]})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:e.jsxs(h,{className:"luxury-card border-0",children:[e.jsxs(u,{children:[e.jsx(f,{className:"font-heading velvet-text",children:"Recent Activity"}),e.jsx(T,{className:"font-body",children:"Latest updates and transactions"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-3",children:[{action:"Dashboard loaded",details:"System statistics updated",time:"Just now"},{action:"Session started",details:`${a.name} logged in`,time:"1 minute ago"},{action:"System ready",details:"BD TicketPro initialized",time:"2 minutes ago"}].map((t,s)=>e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.1,duration:.3},className:"flex items-center justify-between py-3 border-b border-border/20 last:border-b-0 hover:bg-gradient-to-r hover:from-cream-100/50 hover:to-transparent rounded-lg px-2 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-luxury-gold to-luxury-bronze rounded-full animate-glow"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-body font-medium text-sm text-foreground",children:t.action}),e.jsx("p",{className:"font-body text-xs text-foreground/60",children:t.details})]})]}),e.jsx("span",{className:"font-body text-xs text-foreground/50",children:t.time})]},s))})})]})})]})}export{de as D};
